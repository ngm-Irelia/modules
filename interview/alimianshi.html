<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
		<script>
			
			var arr = [
			   {name:'小米1', value: 1,  type: 2, date: '2018-06-07T08:00:01.589Z' },
			   {name:'锤子T1', value: 1, type: 2, date: '2018-06-07T08:10:01.589Z' },
			   {name:'小米2', value: 1, type: 4, date: '2018-06-07T20:00:01.589Z' },
			   {name:'小米2', value: 4, type: 4, date: '2018-06-07T20:10:21.189Z' },
			   {name:'小米4', value: 1, type: 4, date: '2018-06-07T08:00:01.560Z' },
			   {name:'小米4', value: 2, type: 4, date: '2018-06-07T08:10:31.584Z' },
			   {name:'小米6', value: 1, type: 3, date: '2018-06-07T08:00:01.589Z' },
			   {name:'小米5s',value: 1, type: 4, date: '2018-06-07T08:00:01.589Z' },
			   {name:'锤子T2', value: 1, type: 4, date: '2018-06-07T08:00:01.589Z' },
			   {name:'锤子T1', value: 4, type: 4, date: '2018-06-07T08:06:01.589Z' },
			   {name:'魅蓝note5', value: 1, type: 4, date: '2018-06-07T08:00:01.589Z' },
			   {name:'魅蓝note2', value: 5, type: 4, date: '2018-06-02T08:07:01.589Z' },
			   {name:'魅蓝note2', value: 6, type: 4, date: '2018-06-07T08:00:01.589Z' },
			   {name:'魅蓝note3', value: 1, type: 4, date: '2018-06-05T08:00:01.589Z' },
			   {name:'魅蓝note', value: 1, type: 4, date: '2018-06-07T08:00:01.589Z' },
			   {name:'oppor9', value: 7, type: 4, date: '2018-06-04T08:04:01.588Z' },
			   {name:'华为p9', value: 1, type: 4, date: '2018-06-02T08:00:01.577Z' },
			   {name:'华为p9', value: 2, type: 4, date: '2018-06-07T08:00:01.110Z' },
			   {name:'华为p10', value: 1, type: 1, date: '2018-06-07T08:00:01.534Z' }
			];
			function mapToList(map){
				let list = [];
				for (var key in map) {
					list.push( map[key] );
				}
				return list;
			}
			function compare(property) {
        return function (a, b) {
          return a[property] - a[property];
        }
      }
			function dealDate(date){
				let year = date.slice(0,4);
				let month = date.slice(5,7)+1;
				let day = date.slice(8-10);
				return (year +"年" +month+"月"+day+"日”)
			}
			function printArray(arr) {
				let newarr = arr.filter(item => item.type === 4);
				let arrMap = new Map();
				arr.map(item => {
						if(arrMap.has(item.name+item.date.slice(0,10))){
							arrMap.get(item.name+item.date.slice(0,10)).value +=item.value;
						}else{
							arrMap.set(item.name+item.date.slice(0,10), item);
							
						}
				})
				
				let newList = mapToList(arrMap);
				
				newList.sort(compare('value'));
				
				newList.forEach( item => {
					console.log(item.name + ','+ dealDate(item.date)+',售出'+item.value+'部')
				})
			}
			
			printArray(arr);
		</script>
	</body>
</html>
